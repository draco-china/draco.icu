<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/code.svg" />
    <link rel="stylesheet" href="/umi.27fb2de8.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.5.26
    </script>
    <script
      crossorigin="anonymous"
      async="true"
      src="httpshttps://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8911772601296047"
    ></script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <script>
      var _hmt = _hmt || [];
    </script>
    <script>
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?c601bdebcd89b7fc076d669b78e34c6a";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
    <title>页面渲染性能优化 - draco.icu</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/optimization/04-页面渲染性能优化" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="false" data-gapless="false"><div class="__dumi-default-navbar" data-mode="doc"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/code.svg&#x27;)" href="/">draco.icu</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="doc"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/code.svg&#x27;)" href="/"></a><h1>draco.icu</h1><p>I see you, 遇见你</p><p><object type="image/svg+xml" data="https://img.shields.io/github/stars/draco-china/draco.icu?style=social"></object></p></div><div class="__dumi-default-menu-mobile-area"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/reward">吐槽一下</a></li><li><a href="/">Hi there, 👋 I&#x27;m Draco! 😎</a></li><li><a href="/engineering">前端工程化</a><ul><li><a href="/engineering/01-前端代码规范"><span>前端代码规范</span></a></li><li><a href="/engineering/02-前端书籍推荐"><span>前端书籍推荐</span></a></li></ul></li><li><a aria-current="page" class="active" href="/optimization">前端性能优化</a><ul><li><a href="/optimization/00-前端性能优化认知"><span>前端性能优化认知</span></a></li><li><a href="/optimization/01-前端性能分析工具和指标"><span>性能指标和优化目标</span></a></li><li><a href="/optimization/02-浏览器渲染机制"><span>浏览器渲染机制</span></a></li><li><a href="/optimization/03-渲染优化"><span>渲染优化</span></a></li><li><a aria-current="page" class="active" href="/optimization/04-页面渲染性能优化"><span>页面渲染性能优化</span></a></li><li><a href="/optimization/05-静态资源优化"><span>静态资源优化</span></a></li><li><a href="/optimization/06-防抖、节流"><span>防抖、节流</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="浏览器渲染过程" data-depth="2"><a href="/optimization/04-页面渲染性能优化#浏览器渲染过程"><span>浏览器渲染过程</span></a></li><li title="页面渲染技术方案总览" data-depth="2"><a href="/optimization/04-页面渲染性能优化#页面渲染技术方案总览"><span>页面渲染技术方案总览</span></a></li><li title="静态化技术方案" data-depth="2"><a href="/optimization/04-页面渲染性能优化#静态化技术方案"><span>静态化技术方案</span></a></li><li title="前后端分离技术与实现" data-depth="2"><a href="/optimization/04-页面渲染性能优化#前后端分离技术与实现"><span>前后端分离技术与实现</span></a></li><li title="单页面应用技术方案" data-depth="2"><a href="/optimization/04-页面渲染性能优化#单页面应用技术方案"><span>单页面应用技术方案</span></a></li><li title="BigPipe 简介和工作模式" data-depth="2"><a href="/optimization/04-页面渲染性能优化#bigpipe-简介和工作模式"><span>BigPipe 简介和工作模式</span></a></li><li title="同构直出技术方案" data-depth="2"><a href="/optimization/04-页面渲染性能优化#同构直出技术方案"><span>同构直出技术方案</span></a></li><li title="PWA 技术方案和实现思路" data-depth="2"><a href="/optimization/04-页面渲染性能优化#pwa-技术方案和实现思路"><span>PWA 技术方案和实现思路</span></a></li><li title="页面加载策略优化" data-depth="2"><a href="/optimization/04-页面渲染性能优化#页面加载策略优化"><span>页面加载策略优化</span></a></li><li title="懒加载" data-depth="3"><a href="/optimization/04-页面渲染性能优化#懒加载"><span>懒加载</span></a></li><li title="预加载" data-depth="3"><a href="/optimization/04-页面渲染性能优化#预加载"><span>预加载</span></a></li><li title="预渲染" data-depth="3"><a href="/optimization/04-页面渲染性能优化#预渲染"><span>预渲染</span></a></li><li title="按需加载" data-depth="3"><a href="/optimization/04-页面渲染性能优化#按需加载"><span>按需加载</span></a></li><li title="接口服务调用优化" data-depth="2"><a href="/optimization/04-页面渲染性能优化#接口服务调用优化"><span>接口服务调用优化</span></a></li><li title="接口缓存策略优化" data-depth="2"><a href="/optimization/04-页面渲染性能优化#接口缓存策略优化"><span>接口缓存策略优化</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h2 id="浏览器渲染过程"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#浏览器渲染过程"><span class="icon icon-link"></span></a>浏览器渲染过程</h2><p><img src="/static/20210114_2115.da69ce59.png" alt=""/></p><ol><li><p>浏览器解析 HTML，生成 DOM Tree（Parse HTML）。</p></li><li><p>浏览器解析 CSS，生成 CSSOM（CSS Object Model）Tree。</p></li><li><p>JavaScript 会通过 DOM API 和 CSSOM API 来操作 DOM Tree 和 CSS Rule Tree，浏览器将 DOM Tree 和 CSSOM Tree 合成渲染树（Render Tree）。</p></li><li><p>布局（Layout）：根据生成的 Render Tree，进行回流，以计算每个节点的几何信息（位置、大小、字体样式等等）。</p></li><li><p>绘制（Painting）：根据渲染树和回流得到的几何信息，得到每个节点的绝对像素。</p></li><li><p>展示（Display）：将像素发送给图形处理器（GPU），展示在页面上。</p></li></ol><h2 id="页面渲染技术方案总览"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#页面渲染技术方案总览"><span class="icon icon-link"></span></a>页面渲染技术方案总览</h2><p><strong>服务端渲染</strong>：</p><ul><li>后端同步渲染、同构直出、BigPipe。</li></ul><p><strong>客户端渲染</strong>：</p><ul><li><p>JavaScript 渲染：静态化、前后端分离、单页面应用</p></li><li><p>Web App：React、Vue、PWA</p></li><li><p>Hybrid App：PhoneGap 、AppCan 等</p></li><li><p>跨平台开发：RN 、Flutter 、小程序等。</p></li><li><p>原生 App：iOS 、Android</p></li></ul><p>建议：</p><ul><li>依赖业务形式、依赖团队规模、依赖技术水平。</li></ul><h2 id="静态化技术方案"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#静态化技术方案"><span class="icon icon-link"></span></a>静态化技术方案</h2><p>静态化是使动态化的网站生成静态 HTML 页面以供用户更好访问的技术，一般分为纯动态化和伪动态化。</p><p>技术优势：</p><ul><li><p>提高了页面访问速度，降低了服务器的负担，因为访问页面时不需要每次去访问数据库。</p></li><li><p>提高网站内容被搜索引擎搜索到的几率，因为搜索引擎更喜欢静态页面。</p></li><li><p>网站更稳定，如果后端程序、数据库出现问题，会直接影响网站的正常访问，而静态化页面有缓存，更不容易出现问题。</p></li></ul><p>技术不足：</p><ul><li><p>服务器存储占用问题，因为页面量级在增加，要占用大量硬盘空间。</p></li><li><p>静态页面中的链接更新问题会有死链或者错误链接问题。</p></li></ul><p>技术实现：</p><ul><li><p>跑定时任务，将已有的动态内容进行重定，生成静态的 HTML 页面。</p></li><li><p>利用模板技术，将模板引擎中模板字符替换为从数据库字段中取出来的值， 同时生成 HTML 文件。</p></li></ul><p>协作方式：</p><ul><li><p>前端统一写好带有交互的完整静态页面。</p></li><li><p>后端拆分出静态页面文件，并嵌套在后端模板文件中。</p></li></ul><p>选型建议：后端研发人员充分，又需要考虑用户体验、服务器负载的业务。</p><h2 id="前后端分离技术与实现"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#前后端分离技术与实现"><span class="icon icon-link"></span></a>前后端分离技术与实现</h2><p>前后端分离是指研发人员分离、业务代码分离、后端实现业务接口，前端渲染页面。</p><p>技术实现：</p><ul><li><p>后端只负责功能接口实现，提供按照约定的数据格式并封装好的 API 接口。</p></li><li><p>前端负责业务具体实现，获取到 API 接口数据后，进行页面模板拼接和渲染，独立上线。</p></li></ul><p>协作方式：</p><ul><li><p>前端负责实现页面前端交互，根据后端 API 接口拼装前端模板。</p></li><li><p>后端专注于业务功能实现和 API 接口封装。</p></li></ul><p>技术优势：</p><ul><li><p>团队更加专注</p></li><li><p>提升了开发效率</p></li><li><p>增加代码可维护性</p></li></ul><p>技术架构：</p><ul><li><p>后端架构：Java、C++、PHP、 + Nginx，使用微服务（比如 Dubbo 等）等实现业务的解耦，所有的服务使用某种协议提供不同的服务（比如 JSF 等） 。</p></li><li><p>前端架构：使用 Angular、React、Vue 前端框架并部署页面至 CDN。</p></li><li><p>前端架构 2：使用 Angular、React、Vue 前端框架并部署在 Node Server。</p></li></ul><p>技术不足：</p><ul><li><p>因为前端需要负责一大部分业务逻辑实现，和服务端同步、静态化，需要前端人力非常多。</p></li><li><p>页面数据异步渲染，不利于 SEO，搜索引擎更喜欢纯静态页面。</p></li></ul><p>选型建议：</p><ul><li>这是大型互联网公司正在采用的开发模式，一句话，如果考虑用户体验，以及前端人力够用，就可以积极采用。</li></ul><h2 id="单页面应用技术方案"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#单页面应用技术方案"><span class="icon icon-link"></span></a>单页面应用技术方案</h2><p>单页应用（single-page application，缩写 SPA），通过动态重写当前页面，来与用户交互，而非传统的从服务器重新加载整个新页面。这种方法在使用过程中不需要重新加载页面，避免了页面之间切换打断用户体验，使应用程序更像一个桌面应用程序。</p><p>技术优点：</p><ul><li><p>不错的加载速度：用户往往感觉页面加载非常快，因为一进入页面就能看到页面元素；</p></li><li><p>良好的交互体验：进行局部渲染，避免不必要的页面间跳转和重复渲染；</p></li><li><p>前后端职责分离：前端进行页面交互逻辑，后端负责业务逻辑；</p></li><li><p>减轻服务器负载：服务器只处理数据接口输出，不用考虑页面模板渲染和 HTML 展示。</p></li></ul><p>技术缺点：</p><ul><li><p>开发成本相对较高</p></li><li><p>首次页面加载时间过多</p></li><li><p>SEO 难度比较大</p></li></ul><p>技术实现：</p><ul><li>使用 React、Vue 框架可以很好的。</li></ul><h2 id="bigpipe-简介和工作模式"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#bigpipe-简介和工作模式"><span class="icon icon-link"></span></a>BigPipe 简介和工作模式</h2><p>BigPipe 通过将页面加载到称为 Pagelet 的小部件中，来加快页面渲染速度，并允许浏览器在 PHB 服务器呈现页面的同时，一直请求页面不同区块的结构，类似一个“流”传输管道。</p><p><strong>技术实现</strong>：</p><ol><li><p>浏览器从服务器请求页面。</p></li><li><p>Server 迅速呈现一个包含  标记的页面框架，以及一个包含空 div 元素的主体，这些元素充当 Pagelet 的容器。由于该页面尚未完成，因此与浏览器的 HTTP 连接保持打开状态。</p></li><li><p>浏览器将开始下载 bigpipe.js 文件，然后它将开始呈现页面。</p></li><li><p>PHP 服务器进程仍在执行，并且一次构建每个 Pagelet 。Pagelet 完成后，其结果将在<code>&lt;script&gt; BigPipe.onArrive（…）&lt;/ script&gt;</code> 标记内发送到浏览器。</p></li><li><p>浏览器将收到的 html 代码注入正确的位置。如果小页面需要任何 CSS 资源，则也将下载这些 CSS 资源。</p></li><li><p>接收完所有的页面集之后，浏览器将开始加载那些页面集所需的所有外部 JavaScript 文件。</p></li><li><p>下载 JavaScript 后，浏览器将执行所有内联 JavaScript。</p></li></ol><h2 id="同构直出技术方案"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#同构直出技术方案"><span class="icon icon-link"></span></a>同构直出技术方案</h2><p>一套代码既可以在服务端运行又可以在客户端运行，这就是同构（Universal）。</p><p>技术优势：</p><ul><li><p>性能: 降低首屏渲染时间</p></li><li><p>SEO: 服务端渲染对搜索引擎的爬取有着天然的优势</p></li><li><p>兼容性: 有效规避客户端兼容性问题，比如白屏</p></li><li><p>代码同构：直接上线两个版本，利于灾备。</p></li></ul><p>技术实现：</p><ul><li><p>next.js：服务器端渲染 React 组件框架（参考查看：<a target="_blank" rel="noopener noreferrer" href="https://nextjs.org/%EF%BC%89">https://nextjs.org/）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, React 采用 ReactDOMServer 调用 renderToString() 方法。</p></li><li><p>gatsbyjs：服务端 React 渲染框架（参考查看： <a target="_blank" rel="noopener noreferrer" href="https://www.gatsbyjs.org/%EF%BC%89%E3%80%82">https://www.gatsbyjs.org/）。<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p>nuxt.js：服务器端渲染 Vue 组件框架（参考查看：<a target="_blank" rel="noopener noreferrer" href="https://nuxtjs.org/%EF%BC%89">https://nuxtjs.org/）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, Vue 采用 vue-server-renderer 调用 renderToString() 方法。</p></li></ul><p>协作方式：</p><ul><li><p>后端专注于业务功能实现和 API 接口封装。</p></li><li><p>前端负责实现页面前端交互，根据后端 API 接口拼装前端模板，页面渲染，以及服务器维护。</p></li></ul><p>选型建议：</p><ul><li><p>前端要处理 Node server 的机器环境、代码部署、日志、容灾、监控等以往后端人员需要具备运维知识，前端人员的综合能力要求会比以往要高。</p></li><li><p>前端项目开发周期变长了，需要事先和产品、运营沟通排期问题。</p></li></ul><h2 id="pwa-技术方案和实现思路"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#pwa-技术方案和实现思路"><span class="icon icon-link"></span></a>PWA 技术方案和实现思路</h2><p>Progressive Web App，简称 PWA，PWA 应用是使用特定技术和标准模式来开发的 Web 应用，这将同时赋予它们 Web 应用和原生应用的特性。</p><p>技术优势：</p><ul><li><p>用户可以用手机屏幕启动应用，即使在离线状态或者弱网下，通过事先缓存的资源，也可正常加载运行当前应用，可以完全消除对网络的依赖，从而给用户非常可靠的体验。</p></li><li><p>因为预先缓存了资源，部分资源无须经过网络，即秒开页面。</p></li><li><p>和移动设备上的原生应用一样，具有沉浸式的用户体验。</p></li><li><p>可以给用户发送离线推送消息。</p></li></ul><p>技术实现：</p><ul><li><p>全站改造成 HTTPS，没有 HTTPS 就没有 Service Worker。</p></li><li><p>应用 Service Worker 技术提升性能，离线提供静态资源文件，提升首屏用户体验。</p></li><li><p>使用 App Manifest。</p></li><li><p>最后可以考虑离线消息推送等功能。</p></li></ul><p>浏览器兼容性：</p><ul><li><p>ServiceWorkerGlobalScope API：88%</p></li><li><p>Web App Manifest 83%</p></li></ul><h2 id="页面加载策略优化"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#页面加载策略优化"><span class="icon icon-link"></span></a>页面加载策略优化</h2><ul><li><p>懒加载</p></li><li><p>预加载</p></li><li><p>预渲染</p></li><li><p>按需加载</p></li></ul><p>下面具体展开讲讲。</p><h3 id="懒加载"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#懒加载"><span class="icon icon-link"></span></a>懒加载</h3><p>懒加载也叫延迟加载，指的是长网页中延迟加载特定元素（可以是图片，也可以是 JS/CSS 文件，当然也可以是 JavaScript 的特定函数和方法，以下简称“懒加载元素”）。</p><p>好处：可以减少当前屏无效资源的加载。</p><p>技术实现举例：把页面上“懒加载元素”src 属性设置为空字符，把真实的 src 属性写在 data-lazy 属性中，当页面滚动的时候监听 scroll 事件，如果“懒加载元素”在可视区域内，就把图片的 src 属性或者文件 URL 路径设置成 data-lazy 属性值。</p><h3 id="预加载"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#预加载"><span class="icon icon-link"></span></a>预加载</h3><p>可以使用预加载让浏览器来预先加载某些资源（比如图片、JS/CSS/模板），而这些资源是在将来才会被使用到的。简单来说，就是将所需资源提前加载到浏览器本地，这样后面在需要使用的时候就可以直接从浏览器缓存中取了，而不用再重新开始加载。</p><p>使用场景：如果你希望这个资源能尽快显示给用户，就可以使用预加载。</p><p>好处：减少用户后续加载资源等待的时间。</p><p><strong>技术实现举例</strong>：</p><ol><li>HTML 标签：</li></ol><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">img</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">https://xxx.jpg</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag special-attr attr-name">style</span><span class="token tag special-attr attr-value punctuation attr-equals">=</span><span class="token tag special-attr attr-value punctuation">&quot;</span><span class="token tag special-attr attr-value value css language-css property">display</span><span class="token tag special-attr attr-value value css language-css punctuation">:</span><span class="token tag special-attr attr-value value css language-css"> none</span><span class="token tag special-attr attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span></div></pre></div><p>2、使用 Image 对象：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> image </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">image</span><span class="token punctuation">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;https://xxx.jpg&#x27;</span><span class="token punctuation">;</span></div></pre></div><p>3、使用 preload、prefetch 和 preconnect：</p><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">link</span><span class="token tag"> </span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value">“preload”</span><span class="token tag"> </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value">“src/style.css”</span><span class="token tag"> </span><span class="token tag attr-name">as</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value">“style”</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;</span><span class="token tag">link</span><span class="token tag"> </span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">prefetch</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">scr/image.png</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;</span><span class="token tag">link</span><span class="token tag"> </span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">dns-prefetch</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">https://my.com</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;</span><span class="token tag">link</span><span class="token tag"> </span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">preconnect</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">https://my.com</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">crossorigin</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span></div></pre></div><h3 id="预渲染"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#预渲染"><span class="icon icon-link"></span></a>预渲染</h3><p>有一种预加载组件的方式就是提前渲染它。在页面中渲染组件，但是并不在页面中展示。也就是渲染完成后，先隐藏起来，用的时候再展示。</p><p>实现举例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">link</span><span class="token tag"> </span><span class="token tag attr-name">rel</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">prerender</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">https://my.com</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span></div></pre></div><h3 id="按需加载"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#按需加载"><span class="icon icon-link"></span></a>按需加载</h3><ul><li><p>常规按需加载（如 JS 原生、jQuery）</p></li><li><p>不同 App 按需加载（如 JS-SDK 脚本文件）</p></li><li><p>不同设备按需加载（如 PC 端和 HTML5 端样式文件）</p></li><li><p>不同分辨率按需加载（CSS Media Query）</p></li></ul><p>React 异步加载举例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-javascript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">componentA</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter dom variable">location</span><span class="token parameter punctuation">,</span><span class="token parameter"> callback</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  require</span><span class="token punctuation">.</span><span class="token method function property-access">ensure</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;modules/componentA&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token string">&#x27;componentA&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">componentB</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter dom variable">location</span><span class="token parameter punctuation">,</span><span class="token parameter"> callback</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  require</span><span class="token punctuation">.</span><span class="token method function property-access">ensure</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;modules/componentB&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token string">&#x27;componentB&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token maybe-class-name">Router</span><span class="token plain"> history</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token plain">history</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token operator">&lt;</span><span class="token maybe-class-name">Route</span><span class="token plain"> path</span><span class="token operator">=</span><span class="token string">&quot;/&quot;</span><span class="token plain"> component</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token maybe-class-name">App</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token operator">&lt;</span><span class="token maybe-class-name">Route</span><span class="token plain"> path</span><span class="token operator">=</span><span class="token string">&quot;componentA&quot;</span><span class="token plain"> getComponent</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token plain">componentA</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Route</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token operator">&lt;</span><span class="token maybe-class-name">Route</span><span class="token plain"> path</span><span class="token operator">=</span><span class="token string">&quot;componentB&quot;</span><span class="token plain"> getComponent</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token plain">componentB</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Route</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Route</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Router</span><span class="token operator">&gt;</span><span class="token punctuation">;</span></div></pre></div><p>Vue 异步加载举例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-javascript"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Vue</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;vue&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">App</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;./App.vue&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">VueRouter</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;vue-router&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token maybe-class-name">Vue</span><span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token maybe-class-name">VueRouter</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">componentA</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">resolve</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;src/a.vue&#x27;</span><span class="token plain"> </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"> resolve</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">componentB</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">resolve</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;src/b.vue&#x27;</span><span class="token plain"> </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"> resolve</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> router </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">routes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">&quot;a”,name:&quot;</span><span class="token operator">/</span><span class="token plain">a”</span><span class="token punctuation">,</span><span class="token literal-property property">component</span><span class="token operator">:</span><span class="token plain">componentA</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">     </span><span class="token punctuation">{</span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">&quot;b”,name:&quot;</span><span class="token operator">/</span><span class="token plain">b”</span><span class="token punctuation">,</span><span class="token literal-property property">component</span><span class="token operator">:</span><span class="token plain">componentB</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">el</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;#app&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">router</span><span class="token operator">:</span><span class="token plain"> router</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function-variable function">render</span><span class="token operator">:</span><span class="token plain"> </span><span class="token parameter">h</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token function">h</span><span class="token punctuation">(</span><span class="token maybe-class-name">App</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span></div></pre></div><h2 id="接口服务调用优化"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#接口服务调用优化"><span class="icon icon-link"></span></a>接口服务调用优化</h2><p>1、接口合并：一个页面的众多业务接口和依赖的第三方接口，合并为一个部署在集群的接口统一调用，以减少页面接口请求数。</p><p>2、接口上 CDN：主要基于接口性能考虑，我们可以把<strong>不需要实时更新的接口同步至 CDN</strong>，等此接口内容变更之后自动同步至 CDN 集群上。如果一定时间内未请求到数据，会用源站接口再次请求。</p><p>3、接口域名上 CDN：增强可用性、稳定性。</p><p>4、接口降级：核心接口进行降级用基础接口进行业务实现，比如千人千面的推荐接口，在大促时间点可以直接运营编辑的数据。另外如果接口无访问，建议使用兜底数据。</p><p>5、接口监控：监控接口成功率，不只是常说的 TP99，也包括弱网、超时、网络异常、网络切换等一段情况的监控情况。排查出来问题后，需要联合后端、运维、网络岗位人员一并解决。</p><h2 id="接口缓存策略优化"><a aria-hidden="true" tabindex="-1" href="/optimization/04-页面渲染性能优化#接口缓存策略优化"><span class="icon icon-link"></span></a>接口缓存策略优化</h2><p>1、Ajax/fetch 缓存：前端请求时候带上 cache，依赖浏览器本身缓存机制。</p><p>2、本地缓存：异步接口数据优先使用本地 localStorage 中的缓存数据。</p><p>3、多次请求：接口数据本地无 localStorage 缓存数据，重新再次发出 ajax 请求。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/draco-china/draco.icu/edit/main/docs/optimization/04-页面渲染性能优化.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">6/28/2022 03:25:42</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-176586322-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/umi.f60eb23b.js"></script>
    <script src="/docs__optimization__04-页面渲染性能优化.md.01531aae.async.js"></script>
  </body>
</html>
